<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 720 530" fill="none">
  <defs>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap');
      .text { font-family: 'Inter', system-ui, sans-serif; }
      .title { font-size: 18px; font-weight: 700; fill: #1a1a1a; }
      .subtitle { font-size: 14px; font-weight: 600; fill: #333; }
      .label { font-size: 12px; font-weight: 500; fill: #555; }
      .small { font-size: 11px; font-weight: 400; fill: #666; }
      .code { font-family: 'Monaco', 'Consolas', monospace; font-size: 10px; fill: #777; }
    </style>
    <linearGradient id="rootGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0EA5E9;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#0284c7;stop-opacity:0.1" />
    </linearGradient>
    <linearGradient id="entityGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#38bdf8;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#0ea5e9;stop-opacity:0.1" />
    </linearGradient>
    <linearGradient id="voGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#7dd3fc;stop-opacity:0.1" />
      <stop offset="100%" style="stop-color:#38bdf8;stop-opacity:0.1" />
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="720" height="530" fill="#ffffff"/>

  <!-- Title -->
  <text x="360" y="25" text-anchor="middle" class="text title">Agregado (Aggregate)</text>

  <!-- Aggregate Root Container -->
  <g transform="translate(360, 270)">
    <!-- Outer box with rounded corners -->
    <rect x="-300" y="-220" width="600" height="440" rx="16"
          fill="url(#rootGrad)" stroke="#0EA5E9" stroke-width="3"/>

    <!-- Header -->
    <rect x="-300" y="-220" width="600" height="40" rx="16" fill="#0EA5E9"/>
    <rect x="-300" y="-188" width="600" height="16" fill="#0EA5E9"/>
    <text x="0" y="-195" text-anchor="middle" class="text" fill="white" font-size="14" font-weight="600">
      PEDIDO (Aggregate Root)
    </text>

    <!-- Root attributes -->
    <text x="-270" y="-155" class="text label">Atributos do Root:</text>
    <text x="-270" y="-135" class="text code">- clienteId: UUID</text>
    <text x="-270" y="-120" class="text code">- status: StatusPedido</text>
    <text x="-270" y="-105" class="text code">- dataCriacao: LocalDateTime</text>
    <text x="-270" y="-90" class="text code">- total: BigDecimal</text>

    <!-- Entity Box -->
    <g transform="translate(-50, -60)">
      <rect x="-220" y="0" width="200" height="120" rx="10"
            fill="url(#entityGrad)" stroke="#38bdf8" stroke-width="2"/>

      <!-- Header -->
      <rect x="-220" y="0" width="200" height="28" rx="10" fill="#38bdf8"/>
      <rect x="-220" y="20" width="200" height="12" fill="#38bdf8"/>
      <text x="-120" y="19" text-anchor="middle" class="text" fill="white" font-size="12" font-weight="600">
        ITEM (Entidade)
      </text>

      <!-- Content -->
      <text x="-205" y="45" class="text small">Lista&lt;Item&gt; itens</text>
      <line x1="-205" y1="55" x2="-35" y2="55" stroke="#0ea5e9" stroke-width="1"/>
      <text x="-205" y="75" class="text code">- produto: Produto</text>
      <text x="-205" y="92" class="text code">- quantidade: int</text>
      <text x="-205" y="109" class="text code">- precoUnitario: Money</text>
    </g>

    <!-- Value Object Box -->
    <g transform="translate(170, -60)">
      <rect x="-80" y="0" width="160" height="120" rx="10"
            fill="url(#voGrad)" stroke="#7dd3fc" stroke-width="2"/>

      <!-- Header -->
      <rect x="-80" y="0" width="160" height="28" rx="10" fill="#7dd3fc"/>
      <rect x="-80" y="20" width="160" height="12" fill="#7dd3fc"/>
      <text x="0" y="19" text-anchor="middle" class="text" fill="white" font-size="12" font-weight="600">
        ENDEREÇO (VO)
      </text>

      <!-- Content -->
      <text x="-65" y="45" class="text small">EnderecoEntrega</text>
      <line x1="-65" y1="55" x2="65" y2="55" stroke="#38bdf8" stroke-width="1"/>
      <text x="-65" y="75" class="text code">- rua: String</text>
      <text x="-65" y="92" class="text code">- numero: String</text>
      <text x="-65" y="109" class="text code">- cep: String</text>
    </g>

    <!-- Business Methods -->
    <g transform="translate(0, 90)">
      <text x="-270" y="0" class="text label">Métodos de Negócio:</text>
      <text x="-270" y="20" class="text code">+ adicionarItem(item): void</text>
      <text x="-270" y="38" class="text code">+ removerItem(itemId): void</text>
      <text x="-270" y="56" class="text code">+ confirmar(): void</text>
      <text x="-270" y="74" class="text code">+ cancelar(motivo): void</text>
      <text x="-270" y="92" class="text code">+ calcularTotal(): Money</text>
      <text x="-270" y="110" class="text code">+ validate(): ValidationResult</text>
    </g>
  </g>

  <!-- Invariant note -->
  <g transform="translate(480, 50)">
    <rect x="0" y="0" width="200" height="70" rx="8" fill="#fef3c7" stroke="#f59e0b" stroke-width="1"/>
    <text x="100" y="20" text-anchor="middle" class="text label" fill="#92400e">INVARIANTES</text>
    <text x="15" y="40" class="text small" fill="#92400e">• Pedido não pode ficar vazio</text>
    <text x="15" y="58" class="text small" fill="#92400e">• Total deve ser positivo</text>
  </g>

  <!-- External access indicator -->
  <g>
    <path d="M 50 270 L 30 270" stroke="#0EA5E9" stroke-width="3" marker-end="url(#arrowIn)"/>
    <defs>
      <marker id="arrowIn" markerWidth="10" markerHeight="7" refX="0" refY="3.5" orient="auto">
        <polygon points="0 3.5, 10 0, 10 7" fill="#0EA5E9"/>
      </marker>
    </defs>
    <text x="-10" y="255" class="text small">Acesso externo</text>
    <text x="-10" y="295" class="text small">via Repository →</text>
  </g>

  <!-- Legend (outside the main box, aligned with PEDIDO rectangle) -->
  <g transform="translate(60, 505)">
    <circle cx="10" cy="10" r="8" fill="#0EA5E9"/>
    <text x="25" y="14" class="text small">Aggregate Root</text>

    <circle cx="150" cy="10" r="8" fill="#38bdf8"/>
    <text x="165" y="14" class="text small">Entidade</text>

    <circle cx="250" cy="10" r="8" fill="#7dd3fc"/>
    <text x="265" y="14" class="text small">Value Object</text>
  </g>
</svg>
